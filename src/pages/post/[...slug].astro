---
import { CollectionEntry, getCollection } from 'astro:content';
import PostLayout from '../../Layout/PostLayout.astro';
import GlobalHeader from '../../components/GlobalHeader.astro';
import HeroImage from '../../components/HeroImage.astro';
import { TOC } from '../../components/post/TOC';

export async function getStaticPaths() {
    const posts = await getCollection('post');
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}

type Props = CollectionEntry<'post'>;
const post = Astro.props;
const { Content } = await post.render();
---

<PostLayout title={post.data.title} description={post.data.description} article={post.data.article}>
    <GlobalHeader />

    <HeroImage image={post.data.article.image} />

    <artcile id="main-article" class="heti mb-24 select-text relative z-10 pb-12">
        <Content />
    </artcile>
    <aside class="fixed right-4 top-0 z-30">
        <TOC selector="#main-article" client:load />
    </aside>
</PostLayout>
