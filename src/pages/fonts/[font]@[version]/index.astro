---
import Layout from '../../../Layout/Layout.astro';
import FontFamily from '../../../components/fonts/FontFamily.astro';
import { getVersions } from '../../../components/fonts/utils';
export async function getStaticPaths() {
    const { packages } = await fetch(
        'https://cdn.jsdelivr.net/gh/KonghaYao/chinese-free-web-font-storage@branch/index.json'
    ).then((res) => res.json());
    const collection: {
        params: { font: string; version?: string };
        props: { cn: string; versions: string[] };
    }[] = [];
    for (const [en, cn] of Object.entries(packages)) {
        const versions = await getVersions(en);
        const res = versions.map((i) => {
            return {
                params: {
                    font: en,
                    version: i,
                },
                props: { cn: cn as string, versions },
            };
        });
        collection.push(...res);
    }
    return collection;
}

const { font, version } = Astro.params;
const { cn, versions } = Astro.props;
---

<Layout title={cn + ' 中文网字计划'}>
    <section>
        <FontFamily packageName={font!} version={version!} cnName={cn} versions={versions} />
    </section>
</Layout>
