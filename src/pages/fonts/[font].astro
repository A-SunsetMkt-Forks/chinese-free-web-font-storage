---
import Layout from '../../Layout/Layout.astro';
import { getVersions } from '../../components/fonts/utils';

export async function getStaticPaths() {
    const { packages } = await fetch(
        'https://cdn.jsdelivr.net/gh/KonghaYao/chinese-free-web-font-storage@branch/index.json'
    ).then((res) => res.json());
    const collection: {
        params: { font: string };
        props: { version: string };
    }[] = [];
    for (const [en, cn] of Object.entries(packages)) {
        const versions = await getVersions(en);

        collection.push({
            params: { font: en },
            props: { version: versions[0] },
        });
    }
    return collection;
}
const { font } = Astro.params;
const { version } = Astro.props;
const url = `/fonts/${font!}@${version!}`;
---

<Layout>
    <meta http-equiv="refresh" slot="meta" content={`0; url=${url}`} />
</Layout>
